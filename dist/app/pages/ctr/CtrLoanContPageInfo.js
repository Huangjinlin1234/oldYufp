function _defineProperty(e,l,a){return l in e?Object.defineProperty(e,l,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[l]=a,e}define(["./custom/widgets/js/PrdIdInfoSelector.js"],function(e,l){l.ready=function(e,l,a){yufp.lookup.reg("CRUD_TYPE,STD_ZB_CERT_TYP,CONT_TYPE,STD_ZB_CONT_STATUS,APPLY_CHANNEL_TYPE,IMAGE_TYPE"),yufp.custom.vue({el:a.el,data:function(){var e,t=this;return{dataUrl:backend.creditService+"/api/ctr/loan/conts",dataUrlImages:backend.edocService+"/api/query/image/platfrom/files",baseParams:{},imagesParams:{},tableFilters:{ratePctFilter:function(e){return e?yufp.util.toPercent((100*parseFloat(e,4)).toFixed(7)):""}},queryFields:[{placeholder:"合同号",field:"contNo",type:"input"},(e={placeholder:"合同类型",field:"contType",type:"input"},_defineProperty(e,"type","select"),_defineProperty(e,"dataCode","CONT_TYPE"),_defineProperty(e,"datacodeFilter",function(e){this.typeOptions=[];for(var l=0;l<e.length;l++)"03"!=e[l].key&&this.typeOptions.push(e[l])}),e),{placeholder:"渠道名称",field:"channelCode",type:"select",dataCode:"APPLY_CHANNEL_TYPE",change:function(e,l,a){t.$refs.form.fm.prdCode=""}},{placeholder:"产品名称",field:"prdCode",type:"custom",is:"div-prdId-info-selector",params:{prdType:"",type:""},clickFn:function(e,l,a){t.$refs.fromPrd.switch("prdCode","params",{prdType:l.channelNo,type:"code"}),t.$refs.fromPrd.rebuildFn()}},{placeholder:"客户编号",field:"cusId",type:"input"},{placeholder:"证件类型",field:"certType",type:"select",dataCode:"STD_ZB_CERT_TYP",datacodeFilter:function(e){this.typeOptions=[];for(var l=0;l<e.length;l++)"CN03"!=e[l].key&&"HK01"!=e[l].key&&"MO01"!=e[l].key&&"TW01"!=e[l].key&&"TW02"!=e[l].key&&this.typeOptions.push(e[l])}},{placeholder:"证件号码",field:"certCode",type:"input"},{placeholder:"签订日期",field:"signDate",type:"date",value:(new Date).getFullYear()+"-"+((new Date).getMonth()+1<10?"0"+((new Date).getMonth()+1):(new Date).getMonth()+1)+"-"+((new Date).getDate()<10?"0"+(new Date).getDate():(new Date).getDate())},{placeholder:"合同状态",field:"contState",type:"select",dataCode:"STD_ZB_CONT_STATUS"}],queryButtons:[{label:"查询",op:"submit",type:"primary",icon:"search",click:function(e,l){l&&t.$refs.reftable.remoteData(e)}},{label:"重置",op:"reset",type:"primary",icon:"yx-loop2"}],tableColumns:[{label:"合同号",prop:"contNo",sortable:!0,resizable:!0,width:200},{label:"渠道名称",prop:"channelCode",sortable:!0,resizable:!0,dataCode:"APPLY_CHANNEL_TYPE"},{label:"产品编号",prop:"prdCode",sortable:!0,resizable:!0},{label:"产品名称",prop:"prdName",sortable:!0,resizable:!0},{label:"客户编号",prop:"cusId",sortable:!0,resizable:!0},{label:"客户名称",prop:"cusName",sortable:!0,resizable:!0},{label:"证件类型",prop:"certType",sortable:!0,resizable:!0,dataCode:"STD_ZB_CERT_TYP"},{label:"证件号码",prop:"certCode",sortable:!0,resizable:!0},{label:"合同类型",prop:"contType",sortable:!0,resizable:!0,dataCode:"CONT_TYPE"},{label:"合同金额",prop:"contAmt",sortable:!0,resizable:!0,formatter:function(e,l,a){return yufp.util.moneyFormatter(a,2)}},{label:"合同签订日期",prop:"signDate",sortable:!0,resizable:!0},{label:"合同状态",prop:"contState",sortable:!0,resizable:!0,dataCode:"STD_ZB_CONT_STATUS"}],updateFields:[{columnCount:3,fields:[{field:"contNo",label:"合同号",disabled:!0},{field:"contType",label:"合同类型",disabled:!0,type:"select",dataCode:"CONT_TYPE"},{field:"prdId",label:"产品ID",disabled:!0,hidden:!0},{field:"prdCode",label:"产品编号",disabled:!0},{field:"prdName",label:"产品名称",disabled:!0},{field:"channelCode",label:"渠道名称",disabled:!0,type:"select",dataCode:"APPLY_CHANNEL_TYPE"},{field:"cusId",label:"客户编号",disabled:!0},{field:"cusName",label:"客户名称",disabled:!0},{field:"certType",label:"证件类型",disabled:!0,type:"select",dataCode:"STD_ZB_CERT_TYP"},{field:"certCode",label:"证件号码",disabled:!0},{field:"loanTerm",label:"期限",disabled:!0,hidden:!0},{field:"termTimeType",label:"期限类型",disabled:!0,type:"select",dataCode:"STD_ZB_TERM_TYPE",hidden:!0},{field:"approvalAmt",label:"审批金额（元）",disabled:!0,type:"num",formatter:function(e){if(void 0!==e&&null!=e&&!isNaN(e))return yufp.util.moneyFormatter(e,2)},hidden:!0},{field:"contAmt",label:"合同金额（元）",disabled:!0,type:"num",formatter:function(e){if(void 0!==e&&null!=e&&!isNaN(e))return yufp.util.moneyFormatter(e,2)}},{field:"approvalAmt",label:"合同可用金额（元）",disabled:!0,type:"num",formatter:function(e){if(void 0!==e&&null!=e&&!isNaN(e))return yufp.util.moneyFormatter(e,2)},hidden:!0},{field:"contAmt",label:"累计发放金额（元）",disabled:!0,type:"num",formatter:function(e){if(void 0!==e&&null!=e&&!isNaN(e))return yufp.util.moneyFormatter(e,2)},hidden:!0},{field:"contType",label:"合同类型",type:"select",dataCode:"CONT_TYPE",disabled:!0,hidden:!0},{field:"contState",label:"合同状态",type:"select",dataCode:"STD_ZB_CONT_STATUS",disabled:!0},{field:"signDate",label:"合同签订日期",disabled:!0},{field:"createUser",label:"创建人",disabled:!0},{field:"createTime",label:"创建时间",hidden:!1,disabled:!0},{field:"lastUpdateUser",label:"最后更新人",hidden:!1,disabled:!0},{field:"lastUpdateTime",label:"最近更新时间",hidden:!1,disabled:!0},{field:"contStartDt",label:"申请日期",disabled:!0,hidden:!0},{field:"createDate",label:"创建日期",disabled:!0,hidden:!0}]}],ctrFields:[{columnCount:3,fields:[{field:"contNo",label:"合同号",disabled:!0},{field:"serno",label:"业务流水号",disabled:!0},{field:"prdId",label:"产品ID",disabled:!0,hidden:!0},{field:"prdCode",label:"产品编号",disabled:!0},{field:"prdName",label:"产品名称",disabled:!0},{field:"cusId",label:"客户号",disabled:!0},{field:"cusName",label:"客户名称",disabled:!0},{field:"loanUseType",label:"贷款用途",type:"select",dataCode:"LOAN_USE_GENERE",disabled:!0},{field:"cusManager",label:"客户经理号",disabled:!0},{field:"inputBrId",label:"登记机构代码",disabled:!0},{field:"mainBrId",label:"主管机构代码",disabled:!0},{field:"finaBrId",label:"账务机构代码",disabled:!0},{field:"legalOrgCode",label:"法人机构代码",disabled:!0},{field:"legalOrgName",label:"法人机构名称",disabled:!0},{field:"chargeoffBrId",label:"出账机构代码",disabled:!0},{field:"lmtAdjBase",label:"授信基础类型",type:"select",dataCode:"STD_ZB_ADJ_BASE",disabled:!0},{field:"createTime",label:"创建时间",hidden:!0,disabled:!0},{field:"lastUpdateUser",label:"最后更新人",hidden:!0,disabled:!0},{field:"lastUpdateTime",label:"最近更新时间",hidden:!0,disabled:!0}]}],fields1:[{columnCount:3,fields:[{field:"assureMeansMain",label:"担保方式",type:"select",dataCode:"STD_ZB_ASSURE_MEANS",disabled:!0},{field:"assureMeans2",label:"担保方式2",type:"select",dataCode:"STD_ZB_ASSURE_MEANS",disabled:!0},{field:"assureMeans3",label:"担保方式3",type:"select",dataCode:"STD_ZB_ASSURE_MEANS",disabled:!0},{field:"currencyType",label:"币种",type:"select",dataCode:"STD_ZX_CUR_TYPE",disabled:!0},{field:"approvalAmt",label:"审批金额(元)",disabled:!0},{field:"contAmt",label:"合同金额(元)",disabled:!0},{field:"termTimeType",label:"期限时间类型",type:"select",dataCode:"STD_ZB_TERM_TYPE",disabled:!0},{field:"loanTerm",label:"期限",disabled:!0},{field:"loanStartDate",label:"借据起始日",disabled:!0},{field:"loanEndDate",label:"借据到期日",disabled:!0},{field:"rulingIrY",label:"基准利率(年)",type:"num",formatter:function(e){var l=parseFloat(e);return(void 0===l||null==l||isNaN(l))&&(l=0),Number(100*l).toFixed(4)+"%"},disabled:!0},{field:"intRateType",label:"利率类型",type:"select",dataCode:"STD_ZB_EFR_CHNG_IND",disabled:!0},{field:"irExeType",label:"利率变更生效方式",type:"select",dataCode:"STD_ZB_IREXE_TYPE",disabled:!0},{field:"fixedRate",label:"固定利率(年)",disabled:!0,type:"num",formatter:function(e){var l=parseFloat(e);return(void 0===l||null==l||isNaN(l))&&(l=0),Number(100*l).toFixed(4)+"%"}},{field:"irAdjustMode",label:"利率调整方式",type:"select",dataCode:"STD_ZB_IREXE_TYPE",disabled:!0},{field:"calFloatingRate",label:"利率浮动比",disabled:!0,type:"num",formatter:function(e){var l=parseFloat(e);return(void 0===l||null==l||isNaN(l))&&(l=0),Number(100*l).toFixed(4)+"%"}},{field:"realityIrY",label:"执行利率(年)",disabled:!0,type:"num",formatter:function(e){var l=parseFloat(e);return(void 0===l||null==l||isNaN(l))&&(l=0),Number(100*l).toFixed(4)+"%"}},{field:"overdueRate",label:"罚息浮动比",disabled:!0,type:"num",formatter:function(e){var l=parseFloat(e);return(void 0===l||null==l||isNaN(l))&&(l=0),Number(100*l).toFixed(4)+"%"}},{field:"apprIntRateInc",label:"罚息利率增量（挪用利率）",disabled:!0,type:"num",formatter:function(e){var l=parseFloat(e);return(void 0===l||null==l||isNaN(l))&&(l=0),Number(100*l).toFixed(4)+"%"}},{field:"interestAccMode",label:"结息周期",disabled:!0,type:"select",dataCode:"STD_ZB_REPAY_FREQ"},{field:"enterAccount",label:"入账账号",disabled:!0},{field:"cusName",label:"入账账户名称",disabled:!0},{field:"repaymentAccount",label:"还款账号",disabled:!0},{field:"cusName",label:"还款账户名称",disabled:!0},{field:"repaymentDayType",label:"还款日类型",type:"select",dataCode:"REPAY_DAY_TYPE",disabled:!0},{field:"repaymentDay",label:"还款日",disabled:!0},{field:"repaymentSrcDec",label:"还款来源",disabled:!0},{field:"repaymentMode",label:"还款方式",type:"select",dataCode:"STD_PRD_REPAY_MODE",disabled:!0},{field:"fldvalue01",label:"备注1",disabled:!0,hidden:!0},{field:"cancelDate",label:"核销日期",disabled:!0},{field:"repaymentCard",label:"还款卡号",disabled:!0},{field:"loanAccount",label:"贷款账号",disabled:!0},{field:"contType",label:"是否循环",type:"select",dataCode:"STD_ZX_YES_NO",disabled:!0},{field:"changeDate",label:"合同变更日期",disabled:!0},{field:"signDate",label:"合同签订日期",disabled:!0},{field:"contState",label:"合同状态",type:"select",dataCode:"STD_ZB_CONT_STATUS",disabled:!0},{field:"inputId",label:"申请人",disabled:!0}]}],tableColumnsImages:[{label:"合同号",prop:"applySeq",sortable:!0,resizable:!0},{label:"影像类型",prop:"imageType",sortable:!0,resizable:!0,dataCode:"IMAGE_TYPE"},{label:"影像批次号",prop:"batch",sortable:!0,resizable:!0,width:"480",template:function(){return'<template scope="scope">\t     \t\t\t  \t\t\t<a href="javascript:void(0);" style="text-decoration:underline;"@click="_$event(\'custom-row-click\', scope.row)">{{ scope.row.batch }}</a>\t     \t\t\t  \t\t  </template>'}},{label:"上传状态",prop:"state",sortable:!0,resizable:!0},{label:"进件日期",prop:"startDate",sortable:!0,resizable:!0},{label:"上传时间",prop:"createTime",sortable:!0,resizable:!0}],updateButtons:[{label:"返回",type:"primary",icon:"yx-undo2",hidden:!1,click:function(e){t.dialogVisible=!1}},{label:"保存",type:"primary",icon:"check",hidden:!1,click:function(e){var l=!1;if(t.$refs.reform.validate(function(e){l=e}),l){var a="";"EDIT"==t.viewType?a="PUT":"ADD"==t.viewType&&(a="POST"),yufp.service.request({method:a,url:"/api/ctr/loan/cont",data:e,callback:function(e,l,a){0==e?(t.$refs.reftable.remoteData(),t.$message("操作成功"),t.dialogVisible=!1):t.$message("操作失败")}})}}}],buttons6:[{label:"返回",type:"primary",icon:"yx-undo2",hidden:!1,click:function(e){t.dialogVisible=!1}}],height:yufp.frame.size().height-103,dialogVisible:!1,formDisabled:!1,viewType:"DETAIL",viewTitle:yufp.lookup.find("CRUD_TYPE",!1),tabName:"loanCtrInfo",ctrVisible:!0,prdVisible:!1}},methods:{checkPermission:function(e){return!0},switchStatus:function(e,l){this.viewType=e,this.updateButtons[1].hidden=!l,this.formDisabled=!l,this.dialogVisible=!0},addFn:function(){var e=this;e.switchStatus("ADD",!0),e.$nextTick(function(){e.$refs.reform.resetFn()})},modifyFn:function(){1==this.$refs.reftable.selections.length?(this.switchStatus("EDIT",!0),this.$nextTick(function(){var e=this.$refs.reftable.selections[0];yufp.extend(this.$refs.reform.formModel,e)})):this.$message({message:"请先选择一条记录",type:"warning"})},infoFn:function(){if(1==this.$refs.reftable.selections.length){var e=this;this.switchStatus("DETAIL",!1),e.imagesParams={applySeq:e.$refs.reftable.selections[0].contNo,prdCode:e.$refs.reftable.selections[0].prdCode},this.$nextTick(function(){yufp.extend(this.$refs.ctrForm.formModel,this.$refs.reftable.selections[0]),e.$refs.imagesReftable.remoteData(e.imagesParams)})}else this.$message({message:"请先选择一条记录",type:"warning"})},deleteFn:function(){var t=this,e=t.$refs.reftable.selections;if(e.length<1)t.$message({message:"请先选择一条记录",type:"warning"});else{for(var l=e.length,a=[],d=0;d<l;d++)a.push(e[d].contNo);yufp.service.request({method:"DELETE",url:"/api/ctr/loan/cont",data:{contNo:a.join(",")},callback:function(e,l,a){0==e?(t.$refs.reftable.remoteData(),t.$message("操作成功")):t.$message("操作失败")}})}},exportFn:function(){yufp.util.exportExcelByTable({fileName:"下载文件",importType:"service",ref:this.$refs.reftable,url:"",param:{}})},batchSernoClick:function(e){e.applySeq;var l=e.startDate;if(null!=l&&""!=l&&"undefined"!=l)for(;null!=l.match("-");)l=l.replace("-","");this.getRightCode(e)},getRightCode:function(i){var s,e=yufp.session.userId;yufp.service.request({method:"GET",url:backend.consoleService+"/api/s/user/role/by/"+e,callback:function(e,l,a){if(0==e&&0==a.code){s=a.rows;var d=this,t=i.startDate.replace(new RegExp("-","g"),"");yufp.service.request({method:"POST",url:backend.edocService+"/api/doEncode",data:{applySeq:i.applySeq,prdCode:i.prdCode,sessionUserId:yufp.session.userId,sessionUserName:yufp.session.userName,sessionOrgCode:yufp.session.org.orgCode,sessionOrgName:yufp.session.org.orgName,startDate:t,rightCode:s},callback:function(e,l,a){var t=a.rows;0==e&&0==a.code?window.open(t,"_blank"):d.$message("获取影像系统信息失败："+a.message)}})}}})}}})},l.onmessage=function(e,l){},l.destroy=function(e,l){}});