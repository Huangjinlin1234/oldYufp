define(function(e,l){l.ready=function(e,l,a){yufp.lookup.reg("JGCB_DEAL_STATUS,JGCB_DEAL_RESULT"),yufp.custom.vue({el:a.el,data:function(){var a=this;return{expandCollapseName:["1","2"],dataUrl:backend.consoleService+"/api/s/org/repeal",baseParams:{},queryFields:[{placeholder:"撤销机构代码",field:"repealOldOrg",type:"input"},{placeholder:"合并机构代码",field:"repealNewOrg",type:"input"},{placeholder:"处理状态",field:"status",type:"select",dataCode:"JGCB_DEAL_STATUS"},{placeholder:"撤并日期区间",field:"repealDateList",type:"daterange",value:[],editable:!1}],queryButtons:[{label:"查询",op:"submit",type:"primary",icon:"search",click:function(e,l){l&&(null!=e.repealDateList&&(e.beginDate=e.repealDateList[0],e.endDate=e.repealDateList[1]),a.$refs.reftable.remoteData(e))}},{label:"重置",op:"reset",type:"primary",icon:"yx-loop2"}],tableColumns:[{label:"撤并申请流水号",prop:"applySeq",sortable:!0,resizable:!0},{label:"撤销机构号",prop:"repealOldOrg",sortable:!0,resizable:!0},{label:"撤销机构名称",prop:"oldOrgName",sortable:!0,resizable:!0},{label:"合并机构号",prop:"repealNewOrg",sortable:!0,resizable:!0},{label:"合并机构名称",prop:"newOrgName",sortable:!0,resizable:!0},{label:"撤并日期",prop:"repealDate",sortable:!0,resizable:!0},{label:"广播日期（申请日期）",prop:"broadcastDate",sortable:!0,resizable:!0},{label:"处理状态",prop:"status",sortable:!0,resizable:!0,dataCode:"JGCB_DEAL_STATUS"},{label:"上一次处理状态",prop:"preStatus",sortable:!0,resizable:!0,dataCode:"JGCB_DEAL_STATUS"},{label:"取消撤并日期",prop:"cancelRepealDate",sortable:!0,resizable:!0},{label:"创建时间",prop:"createTime",sortable:!0,resizable:!0,hidden:!0},{label:"创建人",prop:"createUser",sortable:!0,resizable:!0,hidden:!0},{label:"最后修改时间",prop:"lastUpdateTime",sortable:!0,resizable:!0,hidden:!0},{label:"最后修改人",prop:"lastUpdateUser",sortable:!0,resizable:!0,hidden:!0},{label:"全局流水号",prop:"bakField1",sortable:!0,resizable:!0,hidden:!0},{label:"当前处理阶段",prop:"bakField2",sortable:!0,resizable:!0,hidden:!0},{label:"备用字段3",prop:"bakField3",sortable:!0,resizable:!0,hidden:!0}],updateFields:[{columnCount:2,fields:[{field:"applySeq",label:"撤并申请流水号"},{field:"repealOldOrg",label:"撤销机构号"},{field:"oldOrgName",label:"撤销机构名称"},{field:"repealNewOrg",label:"合并机构号"},{field:"newOrgName",label:"合并机构名称"},{field:"repealDate",label:"撤并日期"},{field:"broadcastDate",label:"广播日期（申请日期)"},{field:"status",label:"处理状态",dataCode:"JGCB_DEAL_STATUS"},{field:"preStatus",label:"上一次处理状态",dataCode:"JGCB_DEAL_STATUS"},{field:"cancelRepealDate",label:"取消撤并日期"},{field:"createTime",label:"创建时间",hidden:!0},{field:"createUser",label:"创建人",hidden:!0},{field:"lastUpdateTime",label:"最后修改时间",hidden:!0},{field:"lastUpdateUser",label:"最后修改人",hidden:!0},{field:"bakField1",label:"全局流水号",hidden:!0},{field:"bakField2",label:"当前处理阶段",hidden:!0},{field:"bakField3",label:"备用字段3",hidden:!0}]}],updateButtons:[{label:"返回",type:"primary",icon:"yx-undo2",hidden:!1,click:function(e){a.dialogVisible=!1}}],dataUrlHis:backend.consoleService+"/api/s/org/chk/dtl",baseParamsHis:{},queryFields1:[{placeholder:"撤并检查流水号",field:"chkSeq",type:"input"},{placeholder:"检查结果",field:"chkResult",type:"select",dataCode:"JGCB_DEAL_RESULT"},{placeholder:"检查人",field:"checker",type:"input"}],queryButtons1:[{label:"查询",op:"submit",type:"primary",icon:"search",click:function(e,l){l&&a.$refs.reftableHis.remoteData(e)}},{label:"重置",op:"reset",type:"primary",icon:"yx-loop2"}],chkTableColumns:[{label:"撤并检查流水号",prop:"chkSeq",sortable:!0,resizable:!0},{label:"撤并申请流水号",prop:"applySeq",sortable:!0,resizable:!0},{label:"检查时间",prop:"chkTime",sortable:!0,resizable:!0},{label:"检查结果",prop:"chkResult",sortable:!0,resizable:!0,dataCode:"JGCB_DEAL_RESULT"},{label:"检查详情",prop:"chkDetail",sortable:!0,resizable:!0},{label:"检查详情展开",prop:"chkFullDetail",sortable:!0,resizable:!0},{label:"检查人",prop:"checker",sortable:!0,resizable:!0}],chkUpdateFields:[{columnCount:2,fields:[{field:"chkSeq",label:"撤并检查流水号",hidden:!0},{field:"applySeq",label:"撤并申请流水号",hidden:!0},{field:"chkTime",label:"检查时间",hidden:!0},{field:"chkResult",label:"检查结果",dataCode:"JGCB_DEAL_RESULT",hidden:!0},{field:"chkDetail",label:"检查详情",hidden:!0},{field:"chkFullDetail",label:"检查详情展开",type:"textarea"},{field:"checker",label:"检查人",hidden:!0}]}],height:yufp.frame.size().height-103,dialogVisible:!1,formDisabled:!1,viewType:"DETAIL",viewTitle:yufp.lookup.find("CRUD_TYPE",!1)}},methods:{checkPermission:function(e){return!yufp.session.checkCtrl(e,a.menuId)},switchStatus:function(e,l){var a=this;a.viewType=e,a.formDisabled=!l,a.dialogVisible=!0},rowClickFn:function(e,l,a){this.$refs.baseRef.resetFields(),yufp.extend(this.$refs.baseRef.formModel,e)},checkFn:function(){var s=this;if(1==s.$refs.reftable.selections.length){var e=s.$refs.reftable.selections[0];"0"!=e.status&&"9"!=e.status?"5"!=e.status?this.$confirm("是否要重新发起撤并机构检查？","提示").then(function(){yufp.service.request({method:"POST",url:backend.consoleService+"/api/s/org/repeal/chk",data:e,callback:function(e,l,a){0==e?(s.$refs.reftable.remoteData(),s.$message("重新检查完毕，请前往详情页查看数据")):s.$message("检查过程异常！")}})}):s.$message({message:"选中记录已撤并成功，无须重新检查！",type:"warning"}):s.$message({message:"选中记录无需处理！",type:"warning"})}else s.$message({message:"请先选择一条记录",type:"warning"})},repealFn:function(){var s=this;if(1==s.$refs.reftable.selections.length){var e=s.$refs.reftable.selections[0];"0"!=e.status&&"9"!=e.status?"5"!=e.status?"1"!=e.bakField2?this.$confirm("是否要发起强制撤并操作？","提示").then(function(){yufp.service.request({method:"POST",url:backend.consoleService+"/api/s/org/do/repeal",data:e,callback:function(e,l,a){0==e&&0==a.code?(s.$refs.reftable.remoteData(),s.$message("后台撤并中，请稍后。可点击查看当前撤并进度。")):s.$message(a.message)}})}):s.$message({message:"当前记录处于撤并处理中，请耐心等待！",type:"warning"}):s.$message({message:"该记录已经撤并成功，无法重新发起！",type:"warning"}):s.$message({message:"选中记录无需处理！",type:"warning"})}else s.$message({message:"请先选择一条记录",type:"warning"})},infoFn:function(){var e=this;if(1==e.$refs.reftable.selections.length){var l=e.$refs.reftable.selections[0];e.switchStatus("DETAIL",!1),e.baseParamsHis={applySeq:l.applySeq},e.$refs.reftableHis.data=[],e.$nextTick(function(){e.$refs.reftableHis.remoteData()})}else e.$message({message:"请先选择一条记录",type:"warning"})},returnFn:function(){this.dialogVisible=!1}}})},l.onmessage=function(e,l){},l.destroy=function(e,l){}});